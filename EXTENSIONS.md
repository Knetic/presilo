# Extensions

`presilo` tries to comply to the json-schema as closely as possible. Effort is put into making it strictly read what the spec writes.
However, there are cases where practical utility is hampered by this, since `presilo` is doing a great deal more work with schemas than most other applications do. This document lists out the deviations and extensions to the official json-schema spec.

### `minByteLength` and `maxByteLength`

Because the author often finds himself working at a binary level, or with types that strictly require certain string byte lengths, two extension properties are added to string schemas.

 - `minByteLength`: Represents a constraint on the minimum allowable byte length of a string. It is used similarly to `minLength`.
 - `maxByteLength`: Represents a constraint on the maximum allowable byte length of a string. It is used similarly to `maxLength`.

Note that this byte length interpretation is _only_ valid in non-dynamic languages - there is currently no support for `python`, `ruby`, or `mysql`. The author plans to implement support for those when he has more time.

# Limitations

`presilo` tries to port all concepts between all implemented languages. Code generated by `presilo` is intended to work contractually the same between all languages. Unfortunately, this places certain limitations on the amount of features actually allowable in schemas used by presilo.

### Multiple types

`presilo` does not support an array in the place of the `type` field of any schema, unless it contains exactly two members, and one of those members is `null`. `presilo` interprets this to mean "nullable", and will allow null values to be set on that field in generated code. The "type" of the field is the other member of the array, and must be a valid type.

### mysql

While `presilo` does what it can to make meaningful schema constraints for mysql queries, it's not always possible. This section lists out where `mysql` queries are semantically changed from what one might expect:

- Generates one query file to represent all data structures
- Uses "module" not as a harmless namespace, but as the DB name tables should be contained
- Does not attempt to represent arrays
- Assumes internationalized "nvarchar" for all strings
- Provides a best guess for string column length based on constraints for min/max length
- Does not provide a primary key!
- Does not support regex constraints.
- Uses 'bit' to represent booleans, with 0 = true, 1 = false.
- Does not support minimum byte length constraints

### golang marshalling/unmarshalling

By design, the fields of generated golang structs are not always exported. Any field that has any sort of constraint on it is deliberately accessible (outside the package) via getter/setter, to help enforce constraints and use good encapsulation.

Unfortunately, this messes with marshalling and unmarshalling from some types of encodings. JSON encoding works as expected with any fields, but XML encoding does not.
